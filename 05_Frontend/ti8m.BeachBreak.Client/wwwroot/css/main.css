/*
 * Main Stylesheet for ti8m.BeachBreak Frontend
 * Consolidated CSS architecture following best practices
 *
 * Architecture:
 * 1. Variables - CSS custom properties and design tokens
 * 2. Components - Shared UI components (cards, buttons, forms, etc.)
 * 3. Shared Components - Legacy shared component styles
 * 4. Layout - Page layouts, grids, and structural components
 * 5. Utilities - Utility classes for common patterns
 * 6. Assignment Dialogs - Specialized dialog styles
 *
 * This file replaces the distributed inline <style> blocks across components
 * and provides a maintainable, scalable CSS architecture.
 */

/* =============================================
   IMPORT CONSOLIDATED STYLESHEETS
   ============================================= */

/* 1. Design System Variables */
@import url('./shared-variables.css');

/* 2. Modern Component Styles */
@import url('./components.css');

/* 3. Layout & Grid Systems */
@import url('./layout.css');

/* 4. Utility Classes */
@import url('./utilities.css');

/* 5. Legacy Shared Components (maintain compatibility) */
@import url('./shared-components.css');

/* 6. Specialized Dialog Components */
@import url('./assignment-dialogs.css');

/* 7. Unified Questionnaire System (Regular & Review Mode) */
@import url('./questionnaire-unified.css');

/* =============================================
   BASE STYLES & RESETS
   ============================================= */

/* Modern CSS Reset */
*, *::before, *::after {
    box-sizing: border-box;
}

html {
    font-family: var(--font-family-base);
    font-size: var(--font-size-base);
    line-height: var(--line-height-normal);
    color: var(--text-color);
    background-color: var(--background-light);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    scroll-behavior: smooth;
}

body {
    margin: 0;
    padding: 0;
    min-height: 100vh;
}

/* =============================================
   GLOBAL IMPROVEMENTS
   ============================================= */

/* Focus Management for Better Accessibility */
:focus {
    outline: 2px solid var(--focus-border);
    outline-offset: 2px;
}

:focus:not(:focus-visible) {
    outline: none;
}

:focus-visible {
    outline: 2px solid var(--focus-border);
    outline-offset: 2px;
}

/* Improve button focus indicators */
button:focus-visible,
.rz-button:focus-visible,
input[type="button"]:focus-visible,
input[type="submit"]:focus-visible {
    outline: 2px solid var(--focus-border);
    outline-offset: 2px;
}

/* =============================================
   RADZEN INTEGRATION & OVERRIDES
   ============================================= */

/* Ensure Radzen components use our design tokens */
:root {
    /* Map our variables to Radzen's expected names */
    --rz-primary: var(--primary-color);
    --rz-primary-light: var(--primary-color-light);
    --rz-primary-dark: var(--primary-color-dark);
    --rz-secondary: var(--secondary-color);
    --rz-success: var(--success-color);
    --rz-warning: var(--warning-color);
    --rz-danger: var(--danger-color);
    --rz-info: var(--info-color);
    --rz-light: var(--background-light);
    --rz-dark: var(--text-color-dark);

    /* RGB values for alpha transparency */
    --rz-primary-rgb: 37, 99, 235;
    --rz-secondary-rgb: 99, 102, 241;
    --rz-success-rgb: 5, 150, 105;
    --rz-warning-rgb: 217, 119, 6;
    --rz-danger-rgb: 220, 38, 38;
    --rz-info-rgb: 2, 132, 199;

    /* Text color for contrast */
    --rz-text-color: var(--text-color);
}

/* Enhance Radzen Cards with modern styling */
.rz-card {
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    transition: var(--transition-fast);
}

.rz-card:hover {
    box-shadow: var(--shadow-md);
}

/* Enhance Radzen Buttons */
.rz-button {
    border-radius: var(--radius-md);
    font-weight: var(--font-weight-medium);
    transition: var(--transition-fast);
    position: relative;
    overflow: hidden;
}

.rz-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.rz-button:hover::before {
    left: 100%;
}

.rz-button:hover:not(:disabled) {
    transform: translateY(-1px);
}

/* Enhance Radzen Form Controls */
.rz-textbox,
.rz-dropdown,
.rz-datepicker input {
    border-radius: var(--radius-md);
    border: 1px solid var(--border-color);
    transition: var(--transition-fast);
}

.rz-textbox:focus,
.rz-dropdown:focus,
.rz-datepicker input:focus {
    border-color: var(--focus-border);
    box-shadow: 0 0 0 3px var(--focus-ring);
}

/* Enhance Radzen DataGrid */
.rz-datatable {
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    overflow: hidden;
}

.rz-datatable-data tr:hover {
    background: var(--hover-background);
}

/* =============================================
   COMPONENT-SPECIFIC MIGRATIONS
   ============================================= */

/*
 * These classes provide migration paths for components currently using inline styles.
 * They maintain the same visual appearance while using our consolidated CSS architecture.
 */

/* Questionnaire Builder Migration - Standardized to solid color */
.questionnaire-builder-header {
    background: var(--primary-color);
    color: var(--text-white);
    padding: var(--spacing-2xl);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
    margin-bottom: var(--spacing-2xl);
}

/* Question Editor Migration */
.text-question-editor,
.goal-achievement-editor,
.assessment-editor {
    background: var(--background-color);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    overflow: hidden;
}

.text-question-editor .section-card,
.goal-achievement-editor .section-card,
.assessment-editor .section-card {
    margin-bottom: var(--spacing-md);
}

/* Assignment Dialog Migration */
.assignment-dialog,
.bulk-assignment-dialog {
    background: var(--background-color);
    border-radius: var(--radius-lg);
    box-shadow: var(--modal-shadow);
    max-width: 90vw;
    max-height: 90vh;
}

.assignment-header,
.bulk-header {
    background: var(--primary-color);
    color: var(--text-white);
    padding: var(--spacing-2xl);
    margin: calc(-1 * var(--spacing-lg)) calc(-1 * var(--spacing-lg)) var(--spacing-2xl) calc(-1 * var(--spacing-lg));
    border-radius: var(--radius-lg) var(--radius-lg) 0 0;
}

/* Form Section Migration */
.form-section-modern {
    background: var(--background-color);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
}

.form-section-modern .section-title {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--text-color);
    margin-bottom: var(--spacing-md);
    padding-bottom: var(--spacing-sm);
    border-bottom: 1px solid var(--border-light);
}

/* =============================================
   PERFORMANCE OPTIMIZATIONS
   ============================================= */

/* GPU Acceleration for animations */
.questionnaire-card-modern,
.btn-modern,
.modal-content-modern {
    will-change: transform;
}

/* Optimize repaints */
.loading-shimmer-modern,
.progress-bar-animated {
    will-change: background-position, width;
}

/* =============================================
   PRINT STYLES
   ============================================= */

@media print {
    /* Hide interactive elements */
    .btn-modern,
    .page-actions,
    .modal-overlay-modern,
    .transfer-controls {
        display: none !important;
    }

    /* Simplify colors for print */
    .page-header-modern,
    .questionnaire-builder-header {
        background: #f8f9fa !important;
        color: #000 !important;
        box-shadow: none !important;
    }

    /* Ensure readability */
    .questionnaire-card-modern {
        border: 1px solid #000 !important;
        box-shadow: none !important;
        break-inside: avoid;
    }

    /* Optimize text */
    body {
        font-size: 12pt;
        line-height: 1.4;
    }

    h1, h2, h3 {
        page-break-after: avoid;
    }
}

/* =============================================
   PROGRESSIVE ENHANCEMENT
   ============================================= */

/* Enhance experience when JavaScript is available */
.js-enabled .questionnaire-card-modern {
    cursor: pointer;
}

.js-enabled .hover-lift:hover {
    transform: translateY(-2px);
}

/* Fallbacks for older browsers */
@supports not (backdrop-filter: blur(4px)) {
    .modal-overlay-modern {
        background: rgba(0, 0, 0, 0.8);
    }

    .questionnaire-card-modern {
        background: var(--background-color);
    }
}

@supports not (display: grid) {
    .card-grid-modern {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-lg);
    }

    .card-grid-modern > * {
        flex: 1 1 300px;
    }
}

/* =============================================
   BROWSER-SPECIFIC FIXES
   ============================================= */

/* Safari-specific fixes */
@media screen and (-webkit-min-device-pixel-ratio: 0) {
    .questionnaire-card-modern {
        -webkit-backdrop-filter: blur(20px);
    }
}

/* Firefox-specific fixes */
@-moz-document url-prefix() {
    .progress-bar-animated::after {
        display: none; /* Firefox has issues with the shimmer effect */
    }
}

/* Edge-specific fixes */
@supports (-ms-ime-align: auto) {
    .flex-container-modern {
        display: -ms-flexbox;
    }
}

/* =============================================
   CUSTOM SCROLLBAR STYLING
   ============================================= */

/* Webkit browsers (Chrome, Safari, Edge) */
::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: var(--background-light);
    border-radius: var(--radius-sm);
}

::-webkit-scrollbar-thumb {
    background: var(--border-color);
    border-radius: var(--radius-sm);
}

::-webkit-scrollbar-thumb:hover {
    background: var(--border-dark);
}

/* Firefox */
* {
    scrollbar-width: thin;
    scrollbar-color: var(--border-color) var(--background-light);
}

/* =============================================
   DARK MODE ENHANCEMENTS
   ============================================= */

@media (prefers-color-scheme: dark) {
    /* Enhanced dark mode variables */
    :root {
        --background-color: #1a1a1a;
        --background-light: #2a2a2a;
        --background-muted: #3a3a3a;
        --text-color: #ffffff;
        --text-muted: #adb5bd;
        --border-color: #404040;
        --border-light: #505050;
    }

    /* Dark mode specific enhancements */
    .questionnaire-card-modern {
        background: rgba(42, 42, 42, 0.95);
        backdrop-filter: blur(20px);
    }

    .rz-card {
        background: var(--background-light);
        border-color: var(--border-color);
    }

    .rz-datatable {
        background: var(--background-light);
    }

    /* Ensure good contrast in dark mode */
    .text-muted {
        color: #adb5bd !important;
    }
}

/* =============================================
   ANIMATION PREFERENCES
   ============================================= */

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }

    .questionnaire-card-modern:hover,
    .btn-modern:hover,
    .hover-lift:hover,
    .hover-scale:hover {
        transform: none !important;
    }
}

/* Enhanced animations for users who prefer them */
@media (prefers-reduced-motion: no-preference) {
    .questionnaire-card-modern {
        animation: slideInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
}

/* =============================================
   DEBUGGING & DEVELOPMENT HELPERS
   ============================================= */

/* Development mode helpers (remove in production) */
.debug-grid {
    background-image:
        linear-gradient(rgba(255, 0, 0, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 0, 0, 0.1) 1px, transparent 1px);
    background-size: 20px 20px;
}

.debug-outline * {
    outline: 1px solid rgba(255, 0, 0, 0.3) !important;
}

/* Visual regression testing helpers */
.visual-test-marker {
    position: relative;
}

.visual-test-marker::before {
    content: attr(data-test-id);
    position: absolute;
    top: -20px;
    left: 0;
    font-size: 10px;
    color: #ff0000;
    background: rgba(255, 255, 255, 0.9);
    padding: 2px 4px;
    border-radius: 2px;
    z-index: 9999;
}

/* =============================================
   GRADIENT STANDARDIZATION
   ============================================= */

/* Remove all gradients and standardize to solid colors per UI analysis */
.page-header-modern,
.questionnaire-builder-header,
.assignment-header,
.bulk-header,
.dialog-header,
.modal-header {
    background: var(--primary-color) !important;
}

/* Standardize metric cards to consistent colors */
.metric-card[style*="linear-gradient"] {
    background: var(--primary-color) !important;
}

/* Remove inline gradients from commonly used components */
[style*="linear-gradient(135deg, #667eea"] {
    background: var(--primary-color) !important;
}

[style*="linear-gradient(135deg, #f093fb"] {
    background: var(--secondary-color) !important;
}

[style*="linear-gradient(135deg, #4facfe"] {
    background: var(--info-color) !important;
}

[style*="linear-gradient(135deg, #43e97b"] {
    background: var(--success-color) !important;
}

/* =============================================
   QUESTIONNAIRE BUILDER FLATTENING
   ============================================= */

/* Main content container - replaces nested div structure */
.questionnaire-builder-content {
    padding: var(--spacing-lg);
    max-width: 100%;
    margin: 0 auto;
}

/* Question editor section - flattened structure */
.question-editor-section {
    background: var(--background-color);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-lg);
}

.editor-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-lg);
    background: var(--background-light);
    border-bottom: 1px solid var(--border-light);
}

.toolbar-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
}

.editor-title {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--text-color);
    margin: 0;
}

.toolbar-actions {
    display: flex;
    gap: var(--spacing-sm);
}

.editor-content {
    padding: var(--spacing-xl);
    background: var(--background-color);
}

/* Step sections - semantic structure */
.step-section {
    background: var(--background-color);
    /* Removed border and shadow to reduce visual depth */
    border-radius: var(--radius-lg);
    padding: var(--spacing-xl);
    margin-bottom: var(--spacing-lg);
}

.qb-step-header {
    margin-bottom: var(--spacing-xl);
    padding-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--border-light);
}

.step-title {
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-bold);
    color: var(--text-color);
    margin: 0 0 var(--spacing-sm) 0;
}

.step-description {
    font-size: var(--font-size-md);
    color: var(--text-muted);
    margin: 0;
}

/* Step navigation - simplified layout */
.step-navigation {
    display: flex;
    justify-content: flex-end;
    margin-top: var(--spacing-xl);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--border-light);
}

.step-navigation-dual {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: var(--spacing-xl);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--border-light);
}

.publish-actions {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

/* Responsive design for questionnaire builder */
@media (max-width: 768px) {
    .questionnaire-builder-content {
        padding: var(--spacing-md);
    }

    .editor-toolbar {
        flex-direction: column;
        gap: var(--spacing-md);
        align-items: stretch;
    }

    .toolbar-left {
        justify-content: center;
    }

    .step-navigation-dual {
        flex-direction: column;
        gap: var(--spacing-md);
        align-items: stretch;
    }

    .publish-actions {
        justify-content: center;
    }
}

/* Performance optimizations */
.questionnaire-builder-content,
.question-editor-section,
.step-section {
    will-change: transform;
}

/* Focus management */
.step-section:focus-within {
    border-color: var(--focus-border);
    box-shadow: 0 0 0 3px var(--focus-ring);
}

/* =============================================
   TABLE PERFORMANCE OPTIMIZATION
   ============================================= */

/* Virtualized list optimizations */
.virtualized-list-optimized {
    /* Enable GPU acceleration */
    will-change: scroll-position;
    transform: translateZ(0);

    /* Smooth scrolling */
    scroll-behavior: smooth;

    /* Optimize scrollbar */
    scrollbar-width: thin;
    scrollbar-color: var(--border-color) var(--background-light);
}

.virtualized-list-optimized::-webkit-scrollbar {
    width: 8px;
}

.virtualized-list-optimized::-webkit-scrollbar-track {
    background: var(--background-light);
}

.virtualized-list-optimized::-webkit-scrollbar-thumb {
    background: var(--border-color);
    border-radius: var(--radius-sm);
}

.virtualized-list-optimized::-webkit-scrollbar-thumb:hover {
    background: var(--border-dark);
}

/* Optimize card rendering within virtualized list */
.virtualized-list-optimized .questionnaire-card {
    /* Enable GPU layering */
    will-change: transform;
    transform: translateZ(0);

    /* Optimize repaints */
    backface-visibility: hidden;

    /* Contain layout changes */
    contain: layout style paint;

    /* Prevent layout shifts */
    box-sizing: border-box;
    min-height: 180px; /* Match ItemHeight from component */
}

/* Performance optimizations for table rows */
.rz-datatable-data tr {
    /* Enable GPU acceleration for row interactions */
    will-change: background-color;
    transform: translateZ(0);
}

.rz-datatable-data td {
    /* Contain content changes */
    contain: layout style;
}

/* Optimize large data grids */
.rz-datatable {
    /* Enable smooth scrolling */
    scroll-behavior: smooth;

    /* Optimize rendering */
    will-change: scroll-position;
    transform: translateZ(0);
}

/* Memory management for large lists */
@supports (content-visibility: auto) {
    .virtualized-list-optimized .questionnaire-card {
        /* Enable content visibility for better memory usage */
        content-visibility: auto;
        contain-intrinsic-size: 180px;
    }
}

/* Reduce paint complexity */
.large-table-container {
    /* Isolate repaints */
    isolation: isolate;

    /* Optimize scrolling */
    overflow: auto;
    will-change: scroll-position;
}

/* Performance optimizations for filters and search */
.table-filters {
    /* Prevent layout shifts during filtering */
    contain: layout style;

    /* Enable GPU acceleration for filter interactions */
    will-change: opacity;
    transform: translateZ(0);
}

/* Loading state optimizations */
.table-loading-overlay {
    /* Use GPU acceleration */
    will-change: opacity;
    transform: translateZ(0);

    /* Optimize backdrop blur */
    backdrop-filter: blur(2px);
}

/* Responsive performance optimizations */
@media (max-width: 768px) {
    .virtualized-list-optimized {
        /* Reduce scroll smoothness on mobile for better performance */
        scroll-behavior: auto;
    }

    .virtualized-list-optimized .questionnaire-card {
        /* Disable GPU acceleration on low-end mobile devices */
        will-change: auto;
        transform: none;
    }
}

/* Print optimizations */
@media print {
    .virtualized-list-optimized {
        /* Disable virtualization for print */
        height: auto !important;
        overflow: visible !important;
    }
}

/* =============================================
   FLATTENED PAGE STRUCTURE OPTIMIZATION
   ============================================= */

/* Page Container - Replaces nested div structure */
.page-container {
    background: var(--background-color);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
    margin: var(--spacing-lg);
    box-shadow: var(--shadow-sm);
}

/* Page Header - Semantic header structure */
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--spacing-xl);
    padding-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--border-light);
}

.page-title {
    display: flex;
    align-items: center;
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-bold);
    color: var(--primary-color);
    margin: 0 0 var(--spacing-xs) 0;
}

.page-subtitle {
    font-size: var(--font-size-md);
    color: var(--text-muted);
    margin: 0;
    margin-top: var(--spacing-xs);
}

/* Templates Tab Content */
.templates-content {
    padding: var(--spacing-lg);
}

.templates-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-lg);
    gap: var(--spacing-md);
}

.filters-group {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

/* Data Grid Optimizations */
.template-name-cell {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.template-description {
    display: block;
    margin-top: var(--spacing-xs);
}

.template-actions {
    display: flex;
    gap: var(--spacing-xs);
    justify-content: center;
    flex-wrap: wrap;
}

/* Settings Tab Optimization */
.settings-content {
    padding: var(--spacing-lg);
}

.settings-title {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-bold);
    color: var(--text-color);
    margin: 0 0 var(--spacing-lg) 0;
}

.settings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-xl);
}

.settings-card {
    background: var(--background-light);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
    box-shadow: var(--shadow-sm);
}

.card-title {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--text-color);
    margin: 0 0 var(--spacing-md) 0;
    padding-bottom: var(--spacing-sm);
    border-bottom: 1px solid var(--border-light);
}

.setting-item {
    display: flex;
    align-items: center;
    margin-bottom: var(--spacing-sm);
    padding: var(--spacing-sm);
    border-radius: var(--radius-md);
    transition: var(--transition-fast);
}

.setting-item:hover {
    background: var(--hover-background);
}

.number-setting {
    margin-bottom: var(--spacing-md);
}

.setting-label {
    display: block;
    font-weight: var(--font-weight-medium);
    color: var(--text-color);
    margin-bottom: var(--spacing-sm);
}

.settings-actions {
    display: flex;
    justify-content: flex-start;
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--border-light);
}

/* Responsive Design for Flattened Structure */
@media (max-width: 768px) {
    .page-header {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--spacing-md);
    }

    .templates-toolbar {
        flex-direction: column;
        align-items: stretch;
        gap: var(--spacing-sm);
    }

    .filters-group {
        flex-wrap: wrap;
    }

    .settings-grid {
        grid-template-columns: 1fr;
    }

    .template-actions {
        justify-content: flex-start;
    }
}

/* Performance Optimizations for Flattened Structure */
.page-container,
.settings-card,
.template-actions {
    will-change: transform;
}

/* Focus Management for Flattened Structure */
.page-container:focus-within {
    box-shadow: var(--shadow-md);
}

.settings-card:focus-within {
    border-color: var(--focus-border);
    box-shadow: 0 0 0 3px var(--focus-ring);
}