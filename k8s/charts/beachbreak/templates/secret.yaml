apiVersion: v1
kind: Secret
metadata:
  name: {{ include "beachbreak.fullname" . }}-secrets
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "beachbreak.labels" . | nindent 4 }}
type: Opaque
data:
  # Azure Active Directory Secrets (base64 encoded)
  azure-ad-tenant-id: {{ .Values.global.azureAd.tenantId | b64enc | quote }}
  azure-ad-client-id: {{ .Values.global.azureAd.clientId | b64enc | quote }}
  azure-ad-client-secret: {{ .Values.global.azureAd.clientSecret | b64enc | quote }}
  azure-ad-audience: {{ .Values.global.azureAd.audience | b64enc | quote }}
  azure-ad-scope: {{ .Values.global.azureAd.scope | b64enc | quote }}

  # Database Connection String
  database-connection-string: {{ include "beachbreak.databaseConnectionString" . | b64enc | quote }}

  # Additional Database Secrets
  database-password: {{ .Values.global.database.password | b64enc | quote }}

  # JWT Configuration (optional - for custom JWT handling)
  jwt-secret-key: {{ randAlphaNum 64 | b64enc | quote }}

  # Encryption Keys (for sensitive data in database)
  encryption-key: {{ randAlphaNum 32 | b64enc | quote }}

---
{{- if .Values.postgresql.enabled }}
# PostgreSQL specific secrets (if using embedded PostgreSQL)
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "beachbreak.fullname" . }}-postgresql-secrets
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "beachbreak.labels" . | nindent 4 }}
type: Opaque
data:
  postgres-password: {{ .Values.postgresql.auth.postgresPassword | b64enc | quote }}
  password: {{ .Values.postgresql.auth.password | b64enc | quote }}
  username: {{ .Values.postgresql.auth.username | b64enc | quote }}
{{- end }}